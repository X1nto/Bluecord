--- ./discord_94011/src/main/java/com/discord/utilities/textprocessing/DiscordParser.java	2021-12-24 01:10:13.493024700 +0400
+++ ./bluecord/src/main/java/com/discord/utilities/textprocessing/DiscordParser.java	2021-12-24 01:08:33.886263800 +0400
@@ -3,6 +3,7 @@ package com.discord.utilities.textproces
 import android.content.Context;
 import c.a.t.b.b.b;
 import c.a.t.b.b.e;
+import com.discord.models.message.Message;
 import com.discord.simpleast.core.node.Node;
 import com.discord.simpleast.core.parser.Parser;
 import com.discord.utilities.textprocessing.node.EditedMessageNode;
@@ -13,6 +14,8 @@ import java.util.List;
 import java.util.regex.Pattern;
 import kotlin.Metadata;
 import kotlin.NoWhenBranchMatchedException;
+import mods.anti.AntiEdit;
+import mods.view.DeletedMessageNode;
 
 @Metadata(bv = {1, 0, 3}, d1 = {"\u0000D\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000e\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000b\n\u0000\n\u0002\u0018\u0002\n\u0002\b\u0005\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0002\b\n\bÆ\u0002\u0018\u00002\u00020\u0001:\u0001\u001fB\t\b\u0002¢\u0006\u0004\b\u001d\u0010\u001eJA\u0010\u000f\u001a\u00020\u000e2\u0006\u0010\u0003\u001a\u00020\u00022\b\u0010\u0005\u001a\u0004\u0018\u00010\u00042\u0006\u0010\u0007\u001a\u00020\u00062\u0006\u0010\t\u001a\u00020\b2\u0006\u0010\u000b\u001a\u00020\n2\u0006\u0010\r\u001a\u00020\fH\u0007¢\u0006\u0004\b\u000f\u0010\u0010JA\u0010\u0017\u001a\u001a\u0012\u0004\u0012\u00020\u0006\u0012\n\u0012\b\u0012\u0004\u0012\u00020\u00060\u0015\u0012\u0004\u0012\u00020\u00160\u00142\u0006\u0010\u0011\u001a\u00020\f2\u0006\u0010\u0012\u001a\u00020\f2\b\b\u0002\u0010\u0013\u001a\u00020\fH\u0007¢\u0006\u0004\b\u0017\u0010\u0018R.\u0010\u0019\u001a\u001a\u0012\u0004\u0012\u00020\u0006\u0012\n\u0012\b\u0012\u0004\u0012\u00020\u00060\u0015\u0012\u0004\u0012\u00020\u00160\u00148\u0002@\u0002X\u0004¢\u0006\u0006\n\u0004\b\u0019\u0010\u001aR.\u0010\u001b\u001a\u001a\u0012\u0004\u0012\u00020\u0006\u0012\n\u0012\b\u0012\u0004\u0012\u00020\u00060\u0015\u0012\u0004\u0012\u00020\u00160\u00148\u0002@\u0002X\u0004¢\u0006\u0006\n\u0004\b\u001b\u0010\u001aR.\u0010\u001c\u001a\u001a\u0012\u0004\u0012\u00020\u0006\u0012\n\u0012\b\u0012\u0004\u0012\u00020\u00060\u0015\u0012\u0004\u0012\u00020\u00160\u00148\u0002@\u0002X\u0004¢\u0006\u0006\n\u0004\b\u001c\u0010\u001a¨\u0006 "}, d2 = {"Lcom/discord/utilities/textprocessing/DiscordParser;", "", "Landroid/content/Context;", "context", "", "messageText", "Lcom/discord/utilities/textprocessing/MessageRenderContext;", "messageRenderContext", "Lcom/discord/utilities/textprocessing/MessagePreprocessor;", "preprocessor", "Lcom/discord/utilities/textprocessing/DiscordParser$ParserOptions;", "parserOptions", "", "isEdited", "Lcom/facebook/drawee/span/DraweeSpanStringBuilder;", "parseChannelMessage", "(Landroid/content/Context;Ljava/lang/String;Lcom/discord/utilities/textprocessing/MessageRenderContext;Lcom/discord/utilities/textprocessing/MessagePreprocessor;Lcom/discord/utilities/textprocessing/DiscordParser$ParserOptions;Z)Lcom/facebook/drawee/span/DraweeSpanStringBuilder;", "allowMaskedLinks", "supportEntityMentions", "renderBlockQuotes", "Lcom/discord/simpleast/core/parser/Parser;", "Lcom/discord/simpleast/core/node/Node;", "Lcom/discord/utilities/textprocessing/MessageParseState;", "createParser", "(ZZZ)Lcom/discord/simpleast/core/parser/Parser;", "MASKED_LINK_PARSER", "Lcom/discord/simpleast/core/parser/Parser;", "SAFE_LINK_PARSER", "REPLY_PARSER", "<init>", "()V", "ParserOptions", "app_productionGoogleRelease"}, k = 1, mv = {1, 4, 2})
 /* compiled from: DiscordParser.kt */
@@ -88,7 +91,7 @@ public final class DiscordParser {
         return createParser(z2, z3, z4);
     }
 
-    public static final DraweeSpanStringBuilder parseChannelMessage(Context context, String str, MessageRenderContext messageRenderContext, MessagePreprocessor messagePreprocessor, ParserOptions parserOptions, boolean z2) {
+    public static final DraweeSpanStringBuilder parseChannelMessage(Context context, String str, MessageRenderContext messageRenderContext, MessagePreprocessor messagePreprocessor, ParserOptions parserOptions, boolean z2, Message message) {
         Parser<MessageRenderContext, Node<MessageRenderContext>, MessageParseState> parser;
         m.checkNotNullParameter(context, "context");
         m.checkNotNullParameter(messageRenderContext, "messageRenderContext");
@@ -108,6 +111,11 @@ public final class DiscordParser {
             str = "";
         }
         List parse$default = Parser.parse$default(parser, str, MessageParseState.Companion.getInitialState(), null, 4, null);
+        AntiEdit.appendEdits(context, message, parse$default);
+        if (message.deleted) {
+            parse$default.add(new DeletedMessageNode(context));
+            z2 = false;
+        }
         messagePreprocessor.process(parse$default);
         if (z2) {
             parse$default.add(new EditedMessageNode(context));
